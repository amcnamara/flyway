---
subtitle: Prepare
---

{% include enterprise.html %}

The `prepare` command generates a deployment script from a schemaModel, an environment, a diff artifact, or migrations

## Usage examples

### Generate a deployment script to update target database based on schema model

```
flyway prepare -source=schemaModel -target=production -scriptFilename="D__deployment.sql"
```

> [!Important]  
> When the schemas are different between source and target, make sure to
> configure [schema model schemas](<Configuration/Flyway Namespace/Flyway Schema Model Schemas Setting>).
> If a target schema does not exist in the schema model, the generated script will contain SQL for deleting the schema.

### Generate a deployment script to update target database based on source database

```
flyway prepare -source=env:dev -target=production -scriptFilename="D__deployment.sql"
```

### Generate a deployment script from a diff artifact

```
flyway prepare -artifactFilename="myArtifactPath" -changes="-" -scriptFilename="D__deployment.sql"
```

Generates a deployment script which can be executed against a target database to make it match the target of the
original comparison.

The artifact needed for this approach is generated by [`flyway diff`](<Commands/Diff>).

This approach allows for programmatic partial selection of changes to deploy.

### Generate a deployment script from migrations

```
flyway prepare -source=migrations -target=production-equivalent -scriptFilename="D__deployment.sql"
```

Generates a deployment script which can be executed against a target database to deploy all pending migrations.

This is a useful alternative to `flyway migrate` when you need to deploy to equivalent databases where flyway is not
available, or want to review the exact script to be run before execution, but it does come with limitations:

* This approach does not handle Java migrations or other non-SQL migrations
* Callbacks are not supported

This is currently functionally equivalent to running
a [dry run](<https://documentation.red-gate.com/fd/migration-command-dry-runs-275218517.html>) on `migrate`.

## Complete list of parameters for deploying from schema model or source database

### Required

| Parameter                                                                                           | Namespace | Description                                                                              |
|-----------------------------------------------------------------------------------------------------|-----------|------------------------------------------------------------------------------------------|
| [`source`](<Configuration/Flyway Namespace/Flyway Prepare Namespace/Flyway Prepare Source Setting>) | prepare   | Either `schemaModel` or a source database (e.g. `env:dev`) for this workflow.            |
| [`target`](<Configuration/Flyway Namespace/Flyway Prepare Namespace/Flyway Prepare Target Setting>) | prepare   | The target environment to deploy to. This is only required when using a source database. |

### Optional

| Parameter                                                                                                                              | Namespace | Description                                                                                                                 |
|----------------------------------------------------------------------------------------------------------------------------------------|-----------|-----------------------------------------------------------------------------------------------------------------------------|
| [`types`](<Configuration/Flyway Namespace/Flyway Prepare Namespace/Flyway Prepare Types Setting>)                                      | prepare   | A comma separated list of script types to generate.                                                                         |
| [`scriptFilename`](<Configuration/Flyway Namespace/Flyway Prepare Namespace/Flyway Prepare Script Filename Setting>)                   | prepare   | The path to the deployment script that will be generated.                                                                   |
| [`undoFilename`](<Configuration/Flyway Namespace/Flyway Prepare Namespace/Flyway Prepare Undo Filename Setting>)                       | prepare   | The path to the undo script that will be generated.                                                                         |
| [`abortOnWarningSeverity`](<Configuration/Flyway Namespace/Flyway Prepare Namespace/Flyway Prepare Abort On Warning Severity Setting>) | prepare   | Will cause an error to be returned if any warnings of configured severity are raised when generating the deployment script. |
| [`force`](<Configuration/Flyway Namespace/Flyway Prepare Namespace/Flyway Prepare Force Setting>)                                      | prepare   | If the deployment script already exists, overwrite it.                                                                      |
| [`configFiles`](<Command-line Parameters/Config Files Parameter>)                                                                      | (root)    | The location of the flyway configuration files.                                                                             |
| [`encoding`](<Configuration/Flyway Namespace/Flyway Encoding Setting>)                                                                 | (root)    | The encoding to use for the generated script.                                                                               |
| [{environment parameters}](<Configuration/Environments Namespace>)                                                                     | (root)    | Environment configuration for the source and/or target environments.                                                        |
| [`schemaModelLocation`](<Configuration/Flyway Namespace/Flyway Schema Model Location Setting>)                                         | (root)    | The path to the schema model.                                                                                               |
| [`schemaModelSchemas`](<Configuration/Flyway Namespace/Flyway Schema Model Schemas Setting>)                                           | (root)    | The schemas in the schema model.                                                                                            |
| [`workingDirectory`](<Command-line Parameters/Working Directory Parameter>)                                                            | (root)    | The directory to consider the current working directory. All relative paths will be considered relative to this.            |

Universal commandline parameters are listed [here](<Command-line Parameters>).

Note that comparison options, filters, and static data configuration are all supported, but can currently only be
specified within the TOML config file, and can't yet be overridden on the command line

## Complete list of options for deploying from artifact

### Optional

| Parameter                                                                                                                | Namespace | Description                                                                                                      |
|--------------------------------------------------------------------------------------------------------------------------|-----------|------------------------------------------------------------------------------------------------------------------|
| [`artifactFilename`](<Configuration/Flyway Namespace/Flyway Prepare Namespace/Flyway Prepare Artifact Filename Setting>) | prepare   | The path to the diff artifact.                                                                                   |
| [`changes`](<Configuration/Flyway Namespace/Flyway Prepare Namespace/Flyway Prepare Changes Setting>)                    | prepare   | A comma separated list of change ids.                                                                            |
| [`types`](<Configuration/Flyway Namespace/Flyway Prepare Namespace/Flyway Prepare Types Setting>)                        | prepare   | A comma separated list of script types to generate.                                                              |
| [`scriptFilename`](<Configuration/Flyway Namespace/Flyway Prepare Namespace/Flyway Prepare Script Filename Setting>)     | prepare   | The path to the deployment script that will be generated.                                                        |
| [`undoFilename`](<Configuration/Flyway Namespace/Flyway Prepare Namespace/Flyway Prepare Undo Filename Setting>)         | prepare   | The path to the undo script that will be generated.                                                              |
| [`configFiles`](<Command-line Parameters/Config Files Parameter>)                                                        | (root)    | The location of the flyway configuration files.                                                                  |
| [`encoding`](<Configuration/Flyway Namespace/Flyway Encoding Setting>)                                                   | (root)    | The encoding to use for the generated script.                                                                    |
| [`workingDirectory`](<Command-line Parameters/Working Directory Parameter>)                                              | (root)    | The directory to consider the current working directory. All relative paths will be considered relative to this. |

Universal commandline parameters are listed [here](<Command-line Parameters>).

Note that comparison options, filters, and static data configuration are all supported, but can currently only be
specified within the TOML config file, and can't yet be overridden on the command line

## Complete list of options for deploying from migrations

### Required

| Parameter                                                                                           | Namespace | Description                                    |
|-----------------------------------------------------------------------------------------------------|-----------|------------------------------------------------|
| [`source`](<Configuration/Flyway Namespace/Flyway Prepare Namespace/Flyway Prepare Source Setting>) | prepare   | Must be set to `migrations` for this workflow. |

### Optional

| Parameter                                                                                                            | Namespace | Description                                                                                                                          |
|----------------------------------------------------------------------------------------------------------------------|-----------|--------------------------------------------------------------------------------------------------------------------------------------|
| [`target`](<Configuration/Flyway Namespace/Flyway Prepare Namespace/Flyway Prepare Target Setting>)                  | prepare   | The target environment to deploy to.                                                                                                 |
| [`scriptFilename`](<Configuration/Flyway Namespace/Flyway Prepare Namespace/Flyway Prepare Script Filename Setting>) | prepare   | The path to the deployment script that will be generated.                                                                            |
| [`baselineOnMigrate`](<Configuration/Flyway Namespace/Flyway Baseline On Migrate Setting>)                           | (root)    | Whether to generate schema history table as part of the deployment script (required if does not exist in target database).           |
| [`baselineVersion`](<Configuration/Flyway Namespace/Flyway Baseline Version Setting>)                                | (root)    | If `baselineOnMigrate` is set, specifies the baseline version (only subsequent versioned migrations will be included in deployment). |
| [`cherryPick`](<Configuration/Flyway Namespace/Flyway Cherry Pick Setting>)                                          | (root)    | A custom selection of migrations to use for generating the deployment script.                                                        |
| [`configFiles`](<Command-line Parameters/Config Files Parameter>)                                                    | (root)    | The location of the flyway configuration files.                                                                                      |
| [`defaultSchema`](<Configuration/Flyway Namespace/Flyway Default Schema Setting>)                                    | (root)    | The location of the flyway schema history table.                                                                                     |
| [`encoding`](<Configuration/Flyway Namespace/Flyway Encoding Setting>)                                               | (root)    | The encoding to use for the generated script.                                                                                        |
| [{environment parameters}](<Configuration/Environments Namespace>)                                                   | (root)    | Environment configuration for the source and/or target environments.                                                                 |
| [`ignoreMigrationPatterns`](<Configuration/Flyway Namespace/Flyway Ignore Migration Patterns Setting>)               | (root)    | Pattern for excluding migrations from the deployment script.                                                                         |
| [`locations`](<Configuration/Flyway Namespace/Flyway Locations Setting>)                                             | (root)    | Locations of the migrations to deploy.                                                                                               |
| [{placeholders}](<Configuration/Flyway Namespace/Flyway Placeholders Namespace>)                                     | (root)    | Placeholders in migration scripts to replace with runtime information.                                                               |
| [`placeholderPrefix`](<Configuration/Flyway Namespace/Flyway Placeholder Prefix Setting>)                            | (root)    | Placeholder prefix characters.                                                                                                       |
| [`placeholderReplacement`](<Configuration/Flyway Namespace/Flyway Placeholder Replacement Setting>)                  | (root)    | Whether or not to replace placeholders.                                                                                              |
| [`placeholderSeparator`](<Configuration/Flyway Namespace/Flyway Placeholder Separator Setting>)                      | (root)    | Placeholder separator characters.                                                                                                    |
| [`placeholderSuffix`](<Configuration/Flyway Namespace/Flyway Placeholder Suffix Setting>)                            | (root)    | Placeholder suffix characters.                                                                                                       |
| [`workingDirectory`](<Command-line Parameters/Working Directory Parameter>)                                          | (root)    | The directory to consider the current working directory. All relative paths will be considered relative to this.                     |

Universal commandline parameters are listed [here](<Command-line Parameters>).

## JSON output format

```json
{
  "scriptWasGenerated": true,
  "scriptFilename": "C:\\workingDirectory\\D__deployment.sql",
  "includedDependencies": [
    "dbo.someDependency"
  ],
  "warnings": [
    {
      "type": "WARNING_TYPE",
      "message": "Warning message"
    }
  ]
}
```

## Error codes

This command can produce the following error codes:

- [Generic error codes](<Exit codes and error codes/General error codes>)
- [Prepare error codes](<Exit codes and error codes/Prepare error codes>)